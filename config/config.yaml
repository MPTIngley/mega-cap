# StockPulse Configuration
# Optimized 2026-02-02 via stockpulse optimize

email:
  smtp_server: smtp.gmail.com
  smtp_port: 587

database:
  path: data/stockpulse.sqlite

scanning:
  interval_minutes: 15
  market_open: "09:30"
  market_close: "16:00"
  timezone: US/Eastern

trading:
  commission_per_trade: 0.0
  slippage_percent: 0.05
  spread_percent: 0.02

strategies:
  # RSI Mean Reversion - 11.4% return, 1.73 Sharpe
  rsi_mean_reversion:
    enabled: true
    rsi_period: 10
    rsi_oversold: 25
    rsi_overbought: 80
    stop_loss_pct: 5.0
    take_profit_pct: 6.0
    min_confidence: 70

  # Bollinger Squeeze - DISABLED (only 0.6% return)
  bollinger_squeeze:
    enabled: false
    bb_period: 20
    bb_std: 2.5
    squeeze_threshold: 0.04
    min_confidence: 70
    stop_loss_pct: 4.0
    take_profit_pct: 8.0

  # MACD Volume - 13.2% return, 2.21 Sharpe
  macd_volume:
    enabled: true
    macd_fast: 16
    macd_slow: 26
    macd_signal: 7
    volume_threshold: 1.5
    min_confidence: 65
    stop_loss_pct: 3.0
    take_profit_pct: 15.0

  # Z-Score Mean Reversion - 14.9% return, 1.80 Sharpe
  zscore_mean_reversion:
    enabled: true
    lookback_period: 20
    zscore_entry: -2.25
    zscore_exit: 0.5
    min_confidence: 60
    stop_loss_pct: 6.0
    take_profit_pct: 12.0

  # Momentum Breakout - 19.3% return, 2.23 Sharpe
  momentum_breakout:
    enabled: true
    lookback_days: 20
    breakout_threshold: 0.01
    volume_confirmation: 1.3
    min_confidence: 65
    stop_loss_pct: 5.0
    take_profit_pct: 15.0

  # Gap Fade - DISABLED (negative returns -1.3%)
  gap_fade:
    enabled: false
    gap_threshold_pct: 2.5
    max_gap_pct: 6.0
    volume_surge_threshold: 1.2
    min_confidence: 55
    stop_loss_pct: 3.0
    take_profit_pct: 6.0

  # 52-Week Low Bounce - 10.4% return, 3.67 Sharpe (best risk-adjusted!)
  week52_low_bounce:
    enabled: true
    low_threshold_pct: 12.0
    bounce_threshold_pct: 2.0
    volume_surge: 1.5
    min_confidence: 65
    stop_loss_pct: 5.0
    take_profit_pct: 20.0

  # Sector Rotation - 40.2% return, 2.87 Sharpe (TOP performer!)
  sector_rotation:
    enabled: true
    lookback_days: 10
    top_sectors: 2
    min_sector_return: 1.5
    relative_strength_threshold: 1.2
    min_confidence: 65
    stop_loss_pct: 3.0
    take_profit_pct: 8.0

# Strategy allocation weights (based on optimization 2024-08-11 to 2026-02-02)
strategy_allocation:
  sector_rotation: 2.0      # +40.2% return, 2.87 Sharpe - TOP performer
  momentum_breakout: 1.5    # +19.3% return, 2.23 Sharpe
  week52_low_bounce: 1.5    # +10.4% return, 3.67 Sharpe - best risk-adjusted!
  zscore_mean_reversion: 1.2  # +14.9% return, 1.80 Sharpe
  macd_volume: 1.2          # +13.2% return, 2.21 Sharpe
  rsi_mean_reversion: 1.0   # +11.4% return, 1.73 Sharpe
  bollinger_squeeze: 0.0    # DISABLED
  gap_fade: 0.0             # DISABLED

alerts:
  min_confidence_for_email: 65
  daily_digest_time: "17:00"
  quiet_hours_start: "22:00"
  quiet_hours_end: "07:00"
  send_on_new_signal: true
  send_on_position_exit: true
  send_daily_digest: true
  send_error_alerts: true

# Position sizing formula (CONTINUOUS confidence scaling):
#   confidence_mult = 1.0 + (confidence - min_confidence) / (100 - min_confidence) * (max_multiplier - 1.0)
#   final_size = base_size * strategy_weight * confidence_mult
#   final_size = min(final_size, max_position_size_pct)
#
# Example: 90% confidence sector_rotation signal:
#   conf_mult = 1.0 + (90-60)/(100-60) * (2.5-1.0) = 1.0 + 0.75 * 1.5 = 2.125
#   5% * 2.0 (strategy) * 2.125 (conf) = 21.25% â†’ capped at 12%
# Example: 70% confidence rsi signal:
#   conf_mult = 1.0 + (70-60)/(100-60) * (2.5-1.0) = 1.0 + 0.25 * 1.5 = 1.375
#   5% * 1.0 * 1.375 = 6.9%
# Example: 60% confidence (at threshold):
#   conf_mult = 1.0 (minimum)
#   5% * 1.0 * 1.0 = 5%
#
# NOTE: These parameters should be optimized via portfolio optimizer
confidence_scaling:
  enabled: true
  base_size_pct: 5.0              # Starting position size
  min_confidence: 60              # Below this confidence, use 1.0x multiplier
  max_multiplier: 2.5             # At 100% confidence, use this multiplier

universe:
  source: auto
  count: 100
  manual_tickers: []
  refresh_interval_days: 7

portfolio:
  # NOTE: These can be overridden by env vars:
  #   STOCKPULSE_INITIAL_CAPITAL, STOCKPULSE_MAX_POSITIONS
  initial_capital: 100000.0
  max_positions: 40

risk_management:
  # Position sizing limits (see confidence_scaling above for formula)
  max_position_size_pct: 12.0           # Hard cap per position
  min_position_size_pct: 3.0            # Don't open if final size < 3%

  # Per-strategy concentration limit
  max_per_strategy_pct: 70.0            # Never more than 70% in one strategy

  # Sector concentration limit (% of total capital)
  max_sector_concentration_pct: 70.0    # Max 70% in any single sector

  # Portfolio-level limits
  max_portfolio_exposure_pct: 80.0      # Max 80% invested at once
  max_drawdown_disable_pct: 15.0        # Stop trading if drawdown > 15%

  # Churn prevention
  min_days_between_same_ticker: 3

backtest:
  start_date: "2023-01-01"
  end_date: null
  initial_capital: 100000.0
  position_size_pct: 5.0

# Long-term investment scanner (3-year hold strategy)
# Scores stocks on 8 components for value investing opportunities
# Run: stockpulse longterm-scan or stockpulse longterm-backtest
long_term_scanner:
  enabled: true
  run_time: "17:30"
  pe_percentile_threshold: 30
  price_near_52w_low_pct: 15
  min_dividend_yield: 0.0
  min_score: 60
  send_digest: true

  # Scoring weights (should sum to 1.0)
  # NOTE: Optimize via 'stockpulse longterm-backtest'
  weights:
    valuation: 0.15           # P/E, P/B, PEG ratios
    technical: 0.15           # 52-week position, RSI, accumulation
    dividend: 0.10            # Dividend yield
    quality: 0.15             # Profit margin, ROE, debt ratios
    insider: 0.15             # Insider buying (very predictive!)
    fcf_yield: 0.12           # Free cash flow yield (better than P/E)
    earnings_momentum: 0.10   # EPS beat streak
    peer_valuation: 0.08      # Valuation vs sector peers
